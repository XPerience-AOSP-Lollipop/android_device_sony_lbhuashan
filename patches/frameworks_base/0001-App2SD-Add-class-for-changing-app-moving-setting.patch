From 7ec9e9fd8637f021a9fd47b83e919f9a36a64a03 Mon Sep 17 00:00:00 2001
From: bagyusz <phelyx92@gmail.com>
Date: Tue, 7 Oct 2014 14:34:22 +0200
Subject: [PATCH] App2SD-Add-class-for-changing-app-moving-setting

Change-Id: I48463cc7e97325caf7adf5f29610fce8c932f04b
---
 .../com/android/internal/util/slim/AppMoving.java  | 51 ++++++++++++++++++++++
 1 file changed, 51 insertions(+)
 create mode 100644 core/java/com/android/internal/util/slim/AppMoving.java

diff --git a/core/java/com/android/internal/util/slim/AppMoving.java b/core/java/com/android/internal/util/slim/AppMoving.java
new file mode 100644
index 0000000..42ea6b7
--- /dev/null
+++ b/core/java/com/android/internal/util/slim/AppMoving.java
@@ -0,0 +1,51 @@
+/*
+* Copyright (C) 2014 SlimRoms Project
+*
+* Licensed under the Apache License, Version 2.0 (the "License");
+* you may not use this file except in compliance with the License.
+* You may obtain a copy of the License at
+*
+* http://www.apache.org/licenses/LICENSE-2.0
+*
+* Unless required by applicable law or agreed to in writing, software
+* distributed under the License is distributed on an "AS IS" BASIS,
+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+* See the License for the specific language governing permissions and
+* limitations under the License.
+*/
+
+package com.android.internal.util.slim;
+
+import android.util.Log;
+
+import java.io.File;
+import java.io.IOException;
+
+public class AppMoving {
+    private static final String TAG = "AppMoving";
+    private static final String DISABLE_FILE = "/data/system/no-external-apps";
+
+    public static boolean isEnabled() {
+        return !new File(DISABLE_FILE).exists();
+    }
+
+    private static void removeFile() {
+        new File(DISABLE_FILE).delete();
+    }
+
+    private static void createFile() {
+        try {
+            new File(DISABLE_FILE).createNewFile();
+        } catch (IOException e) {
+            Log.e(TAG, "Failed to create " + DISABLE_FILE + ": " + e.getMessage());
+        }
+    }
+
+    public static synchronized void setEnabled(boolean enable) {
+        if (enable) {
+            removeFile();
+        } else {
+            createFile();
+        }
+    }
+}
-- 
1.9.2

